function out = KK11(x,k,B,G,s,r)
    % This is using formulas I derived
    
    D1 = G + B*sqrt((3-k)/(1+k));
    D2 = B - G*sqrt((3-k)/(1+k));
    D3 = G - B*sqrt((3-k)/(1+k));
    D4 = B + G*sqrt((3-k)/(1+k));
    
    n = zeros(4,length(x));
    m = zeros(4,length(x));
    n(1,:) = -(1/2).*(D1 + sqrt(D1^2 + 4.*(x.^2 + i.*x.*D2)));
    n(2,:) = -(1/2).*(D3 + sqrt(D3^2 + 4.*(x.^2 + i.*x.*D4)));
    n(3,:) = -(1/2).*(D1 - sqrt(D1^2 + 4.*(x.^2 + i.*x.*D2)));
    n(4,:) = -(1/2).*(D3 - sqrt(D3^2 + 4.*(x.^2 + i.*x.*D4)));
    
    for jj = 1:4
       m(jj,:) = ((i.*2.*x - B.*(3-k)).*n(jj,:) + i.*x.*G.*(k-1))./((k-1).*n(jj,:).^2 + (k-1).*G.*n(jj,:) - (k+1).*x.*(x + i*B));
    end
    
    f31 = n(3,:).*m(3,:).*(n(4,:) - n(1,:)) + n(4,:).*m(4,:).*(n(1,:) - n(3,:)) + n(1,:).*m(1,:).*(n(3,:) - n(4,:));
    f32 = n(3,:).*m(3,:).*(n(4,:) - n(2,:)) + n(4,:).*m(4,:).*(n(2,:) - n(3,:)) + n(2,:).*m(2,:).*(n(3,:) - n(4,:));
    f21 = m(4,:).*m(1,:).*(n(4,:) - n(1,:)) + m(3,:).*m(1,:).*(n(1,:) - n(3,:)) + m(3,:).*m(4,:).*(n(3,:) - n(4,:));
    f22 = m(4,:).*m(2,:).*(n(4,:) - n(2,:)) + m(3,:).*m(2,:).*(n(2,:) - n(3,:)) + m(3,:).*m(4,:).*(n(3,:) - n(4,:));
    f11 = n(3,:).*m(4,:).*m(1,:).*(n(4,:) - n(1,:)) + n(4,:).*m(3,:).*m(1,:).*(n(1,:) - n(3,:)) + n(1,:).*m(3,:).*m(4,:).*(n(3,:) - n(4,:));
    f12 = n(3,:).*m(4,:).*m(2,:).*(n(4,:) - n(2,:)) + n(4,:).*m(3,:).*m(2,:).*(n(2,:) - n(3,:)) + n(2,:).*m(3,:).*m(4,:).*(n(3,:) - n(4,:));
    f41 = m(3,:).*(n(4,:) - n(1,:)) + m(4,:).*(n(1,:) - n(3,:)) + m(1,:).*(n(3,:) - n(4,:));
    f42 = m(3,:).*(n(4,:) - n(2,:)) + m(4,:).*(n(2,:) - n(3,:)) + m(2,:).*(n(3,:) - n(4,:));
    
    R0 = (m(4,:) - m(3,:)).*((1+k).*n(3,:).*n(4,:) + (3-k).*x.^2) + i.*x.*(n(4,:) - n(3,:)).*(1 + k - (3-k).*m(3,:).*m(4,:));

    xi = (k+1)./(4.*(k-1)).*(-i.*x.*m(1,:).*(3-k) + n(1,:).*(k+1));
    eta = (k+1)./(4.*(k-1)).*(-i.*x.*m(2,:).*(3-k) + n(2,:).*(k+1));
    a = (-i.*x.*(1+k)./R0).*(f11 - i.*x.*f41);
    b = (-i.*x.*(1+k)./R0).*(f12 - i.*x.*f42);
    c = (-i.*x./R0).*(-(1+k).*f31 + i.*x.*(3-k).*f21);
    d = (-i.*x./R0).*(-(1+k).*f32 + i.*x.*(3-k).*f22);
    
    
    K11 = (xi.*d - eta.*c)./(a.*d - b.*c);
%     out = K11;
     
    
    % Negative alpha
        
    y = -x;

    ny = zeros(4,length(y));
    my = zeros(4,length(y));
    ny(1,:) = -(1/2).*(D1 + sqrt(D1^2 + 4.*(y.^2 + i.*y.*D2)));
    ny(2,:) = -(1/2).*(D3 + sqrt(D3^2 + 4.*(y.^2 + i.*y.*D4)));
    ny(3,:) = -(1/2).*(D1 - sqrt(D1^2 + 4.*(y.^2 + i.*y.*D2)));
    ny(4,:) = -(1/2).*(D3 - sqrt(D3^2 + 4.*(y.^2 + i.*y.*D4)));
    
    for jj = 1:4
       my(jj,:) = ((i.*2.*y - B.*(3-k)).*ny(jj,:) + i.*y.*G.*(k-1))./((k-1).*ny(jj,:).^2 + (k-1).*G.*ny(jj,:) - (k+1).*y.*(y + i*B));
    end
    
    f31y = ny(3,:).*my(3,:).*(ny(4,:) - ny(1,:)) + ny(4,:).*my(4,:).*(ny(1,:) - ny(3,:)) + ny(1,:).*my(1,:).*(ny(3,:) - ny(4,:));
    f32y = ny(3,:).*my(3,:).*(ny(4,:) - ny(2,:)) + ny(4,:).*my(4,:).*(ny(2,:) - ny(3,:)) + ny(2,:).*my(2,:).*(ny(3,:) - ny(4,:));
    f21y = my(4,:).*my(1,:).*(ny(4,:) - ny(1,:)) + my(3,:).*my(1,:).*(ny(1,:) - ny(3,:)) + my(3,:).*my(4,:).*(ny(3,:) - ny(4,:));
    f22y = my(4,:).*my(2,:).*(ny(4,:) - ny(2,:)) + my(3,:).*my(2,:).*(ny(2,:) - ny(3,:)) + my(3,:).*my(4,:).*(ny(3,:) - ny(4,:));
    f11y = ny(3,:).*my(4,:).*my(1,:).*(ny(4,:) - ny(1,:)) + ny(4,:).*my(3,:).*my(1,:).*(ny(1,:) - ny(3,:)) + ny(1,:).*my(3,:).*my(4,:).*(ny(3,:) - ny(4,:));
    f12y = ny(3,:).*my(4,:).*my(2,:).*(ny(4,:) - ny(2,:)) + ny(4,:).*my(3,:).*my(2,:).*(ny(2,:) - ny(3,:)) + ny(2,:).*my(3,:).*my(4,:).*(ny(3,:) - ny(4,:));
    f41y = my(3,:).*(ny(4,:) - ny(1,:)) + my(4,:).*(ny(1,:) - ny(3,:)) + my(1,:).*(ny(3,:) - ny(4,:));
    f42y = my(3,:).*(ny(4,:) - ny(2,:)) + my(4,:).*(ny(2,:) - ny(3,:)) + my(2,:).*(ny(3,:) - ny(4,:));
    
    R0y = (my(4,:) - my(3,:)).*((1+k).*ny(3,:).*ny(4,:) + (3-k).*y.^2) + i.*y.*(ny(4,:) - ny(3,:)).*(1 + k - (3-k).*my(3,:).*my(4,:));

    xiy = (k+1)./(4.*(k-1)).*(-i.*y.*my(1,:).*(3-k) + ny(1,:).*(k+1));
    etay = (k+1)./(4.*(k-1)).*(-i.*y.*my(2,:).*(3-k) + ny(2,:).*(k+1));
    ay = (-i.*y.*(1+k)./R0y).*(f11y - i.*y.*f41y);
    by = (-i.*y.*(1+k)./R0y).*(f12y - i.*y.*f42y);
    cy = (-i.*y./R0y).*(-(1+k).*f31y + i.*y.*(3-k).*f21y);
    dy = (-i.*y./R0y).*(-(1+k).*f32y + i.*y.*(3-k).*f22y);
    
    
    K11y = (xiy.*dy - etay.*cy)./(ay.*dy - by.*cy);
    
    out = (K11.*exp(i.*x.*(s-r))) + K11y.*exp(i.*y.*(s-r));

    
end